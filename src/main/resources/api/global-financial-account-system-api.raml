#%RAML 1.0
title: Global Financial Account System API
version: 1.0.1
mediaType: application/json

documentation:
  - title: Overview
    content: API système pour gérer les comptes financiers dans Global Data (copie dorée)

types:
  FinancialAccount:
    type: object
    properties:
      id?: string
      globalId?: string
      accountNumber: string
      accountType: string
      accountName?: string
      currency?: string
      balance?: number
      availableBalance?: number
      owners:
        type: array
        items:
          type: object
          properties:
            customerGlobalId: string
            relationshipType: string
      status?: string
    example:
      globalId: "550e8400-e29b-41d4-a716-446655440000"
      accountNumber: "ACC-123456789"
      accountType: "Checking"
      accountName: "Main Checking Account"
      currency: "USD"
      balance: 5000.00
      availableBalance: 4800.00
      owners:
        - customerGlobalId: "c1c27e05-7e59-4f39-a7f6-7ffe9ee10d64"
          relationshipType: "Primary"
      status: "Active"
  FinancialTransaction:
    type: object
    properties:
      id?: string
      globalId?: string
      transactionNumber: string
      accountGlobalId: string
      transactionType: string
      amount: number
      currency?: string
      transactionDate: datetime
      description?: string
      status?: string
    example:
      globalId: "660e8400-e29b-41d4-a716-446655440001"
      transactionNumber: "TXN-20260128-001"
      accountGlobalId: "550e8400-e29b-41d4-a716-446655440000"
      transactionType: "Debit"
      amount: 100.00
      currency: "USD"
      transactionDate: "2026-01-28T10:30:00Z"
      description: "Purchase at Store XYZ"
      status: "Posted"
  FinancialCard:
    type: object
    properties:
      id?: string
      globalId?: string
      cardNumber: string
      cardType: string
      cardNetwork?: string
      customerGlobalId: string
      accountGlobalId?: string
      cardholderName?: string
      expirationDate?: date-only
      status?: string
      creditLimit?: number
      availableCredit?: number
      controls?:
        type: object
        properties:
          dailyPurchaseLimit?: number
          dailyATMWithdrawalLimit?: number
          internationalTransactionsEnabled?: boolean
          onlineTransactionsEnabled?: boolean
      issuedDate?: date-only
      createdAt?: datetime
      updatedAt?: datetime
    example:
      globalId: "770e8400-e29b-41d4-a716-446655440002"
      cardNumber: "4532-1234-5678-9010"
      cardType: "CreditCard"
      customerGlobalId: "c1c27e05-7e59-4f39-a7f6-7ffe9ee10d64"
      accountGlobalId: "550e8400-e29b-41d4-a716-446655440000"
      status: "Active"
      creditLimit: 10000
      availableCredit: 8500
      controls:
        dailyPurchaseLimit: 2000
        dailyATMWithdrawalLimit: 500
        internationalTransactionsEnabled: true
        onlineTransactionsEnabled: true
  ErrorResponse:
    type: object
    properties:
      error:
        type: object
        properties:
          code: string
          message: string
    example:
      error:
        code: "NOT_FOUND"
        message: "Account not found"

traits:
  hasQueryParam:
    queryParameters:
      limit:
        type: integer
        required: false
        default: 100
      offset:
        type: integer
        required: false
        default: 0

/accounts:
  displayName: Global Financial Accounts
  description: Opérations sur les comptes financiers dans Global Data
  
  get:
    displayName: Get Accounts
    is: [hasQueryParam]
    queryParameters:
      globalId:
        type: string
        required: false
      customerGlobalId:
        type: string
        required: false
      accountNumber:
        type: string
        required: false
      accountType:
        type: string
        required: false
    responses:
      200:
        body:
          application/json:
            type: FinancialAccount[]
      400:
        body:
          application/json:
            type: ErrorResponse

  post:
    displayName: Upsert Account
    body:
      application/json:
        type: FinancialAccount
        example:
          globalId: "550e8400-e29b-41d4-a716-446655440000"
          accountNumber: "ACC-123456789"
          accountType: "Checking"
          accountName: "Main Checking Account"
          currency: "USD"
          balance: 5000.00
          availableBalance: 4800.00
          status: "Active"
          owners:
            - customerGlobalId: "c1c27e05-7e59-4f39-a7f6-7ffe9ee10d64"
              relationshipType: "Primary"
    responses:
      200:
        body:
          application/json:
            type: FinancialAccount
      201:
        body:
          application/json:
            type: FinancialAccount

  /{accountGlobalId}:
    displayName: Account by Global ID
    uriParameters:
      accountGlobalId:
        type: string
    get:
      displayName: Get Account by Global ID
      responses:
        200:
          body:
            application/json:
              type: FinancialAccount
        404:
          body:
            application/json:
              type: ErrorResponse

  /transactions:
    displayName: Transactions
    get:
      displayName: Get Transactions
      is: [hasQueryParam]
      queryParameters:
        accountGlobalId:
          type: string
          required: false
        startDate:
          type: date-only
          required: false
        endDate:
          type: date-only
          required: false
      responses:
        200:
          body:
            application/json:
              type: FinancialTransaction[]
    post:
      displayName: Upsert Transaction
      body:
        application/json:
          type: FinancialTransaction
          example:
            globalId: "660e8400-e29b-41d4-a716-446655440001"
            transactionNumber: "TXN-20260128-001"
            accountGlobalId: "550e8400-e29b-41d4-a716-446655440000"
            transactionType: "Debit"
            amount: 100.00
            currency: "USD"
            transactionDate: "2026-01-28T10:30:00Z"
            description: "Purchase at Store XYZ"
            status: "Posted"
      responses:
        200:
          body:
            application/json:
              type: FinancialTransaction
        201:
          body:
            application/json:
              type: FinancialTransaction

  /cards:
    displayName: Cards
    get:
      displayName: Get Cards
      is: [hasQueryParam]
      queryParameters:
        customerGlobalId:
          type: string
          required: false
        accountGlobalId:
          type: string
          required: false
      responses:
        200:
          body:
            application/json:
              type: FinancialCard[]
    post:
      displayName: Upsert Card
      body:
        application/json:
          type: FinancialCard
          example:
            globalId: "770e8400-e29b-41d4-a716-446655440002"
            cardNumber: "4532-1234-5678-9010"
            cardType: "CreditCard"
            customerGlobalId: "c1c27e05-7e59-4f39-a7f6-7ffe9ee10d64"
            accountGlobalId: "550e8400-e29b-41d4-a716-446655440000"
            status: "Active"
      responses:
        200:
          body:
            application/json:
              type: FinancialCard
        201:
          body:
            application/json:
              type: FinancialCard

    /{cardGlobalId}:
      displayName: Card by Global ID
      uriParameters:
        cardGlobalId:
          type: string
          description: UUID of the card in Global Data
      get:
        displayName: Get Card by Global ID
        description: Retrieve a specific card by its global ID
        responses:
          200:
            body:
              application/json:
                type: FinancialCard
          404:
            body:
              application/json:
                type: ErrorResponse
      put:
        displayName: Update Card
        description: Update card details including controls
        body:
          application/json:
            type: FinancialCard
            example:
              globalId: "a0b737cd-d427-0e2e-4e03-122fc40fa5a6"
              cardNumber: "4532-****-****-1234"
              cardType: "CreditCard"
              customerGlobalId: "3ae102cf-d871-4f69-8847-566fc949a9a0"
              controls:
                dailyPurchaseLimit: 2000
                dailyATMWithdrawalLimit: 500
                internationalTransactionsEnabled: false
                onlineTransactionsEnabled: true
        responses:
          200:
            body:
              application/json:
                type: FinancialCard
          404:
            body:
              application/json:
                type: ErrorResponse
